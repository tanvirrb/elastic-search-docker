'use strict'

const { Transport, WeightedConnectionPool, UndiciConnection } = require('./')

const pool = new WeightedConnectionPool({ Connection: UndiciConnection })
pool.addConnection('http://localhost:3000')
const transport = new Transport({ connectionPool: pool })

async function run () {
  for (let i = 0; i < 1000; i++) {
    await transport.request({ method: 'GET', path: '/' })
  }
}

run().catch(err => {
  console.log(err)
  process.exit(1)
})
